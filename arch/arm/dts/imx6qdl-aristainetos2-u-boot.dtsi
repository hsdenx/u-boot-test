// SPDX-License-Identifier: GPL-2.0+ or X11
/*
 * Copyright (C) 2019 Heiko Schocher <hs@denx.de>
 */

/ {
	leds {
		compatible = "gpio-leds";
		pinctrl-names = "default";
		pinctrl-0 = <&pinctrl_gpio>;

		LED_blue {
			label = "led_blue";
			gpios = <&gpio2 29 GPIO_ACTIVE_LOW>;
		};

		LED_ena {
			label = "led_ena";
			gpios = <&gpio1 25 GPIO_ACTIVE_LOW>;
		};

		LED_green {
			label = "led_green";
			gpios = <&gpio5 4 GPIO_ACTIVE_LOW>;
		};

		LED_red {
			label = "led_red";
			gpios = <&gpio2 28 GPIO_ACTIVE_LOW>;
		};

		LED_yellow {
			label = "led_yellow";
			gpios = <&gpio6 16 GPIO_ACTIVE_LOW>;
		};
	};
};

&backlight {
	pwms = <&pwm1 0 300000>;
	default-brightness-level = <2>;
};

&iomuxc {
	pinctrl-0 = <&pinctrl_gpio &pinctrl_gpio_fix>;

	pinctrl_gpio_fix: gpiofixgrp {
		/*
		 * usdhc2 has a levelshifter on the carrier board Rev. DV1,
		 * that will automatically detect the driving direction.
		 * During initialisation this isn't working correctly,
		 * which causes DAT3 to be driven low towards the SD-card.
		 * This causes a SD-card enetring the SPI-Mode
		 * and therefore getting inaccessible until next power cycle.
		 * As workaround we drive the DAT3 line as GPIO and set it high.
		 * This makes usdhc2 unusable in u-boot, but works for the
		 * initialisation in Linux
		 */
		fsl,pins = <
			MX6QDL_PAD_SD2_DAT3__GPIO1_IO12	0x20000
		>;
	};
};

&gpio1 {
	usdhc_fix {
		gpio-hog;
		output-high;
		gpios = <12 GPIO_ACTIVE_HIGH>;
	};
};

&gpio2 {
	ena_spi_nor {
		gpio-hog;
		output-high;
		gpios = <15 GPIO_ACTIVE_HIGH>;
	};
};

&gpio6 {
	spi_bus_ena {
		gpio-hog;
		output-high;
		gpios = <6 GPIO_ACTIVE_HIGH>;
	};
};

&gpio7 {
	bootsel0 {
		gpio-hog;
		input;
		gpios = <6 GPIO_ACTIVE_HIGH>;
	};
	bootsel1 {
		gpio-hog;
		input;
		gpios = <7 GPIO_ACTIVE_HIGH>;
	};
	bootsel2 {
		gpio-hog;
		input;
		gpios = <1 GPIO_ACTIVE_HIGH>;
	};

	soft_reset {
		gpio-hog;
		output-high;
		gpios = <13 GPIO_ACTIVE_HIGH>;
	};
	sd2_driver_ena {
		gpio-hog;
		output-high;
		gpios = <8 GPIO_ACTIVE_HIGH>;
	};

};
